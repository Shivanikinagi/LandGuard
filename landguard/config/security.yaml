# Security configuration for LandGuard

# Authentication settings
authentication:
  # Enable API key authentication
  enable_api_key: true
  
  # Enable JWT authentication
  enable_jwt: true
  
  # JWT settings
  jwt:
    secret_key: "${LANDGUARD_JWT_SECRET}"  # Load from environment
    algorithm: "HS256"
    token_expiry_hours: 24
    refresh_enabled: true
  
  # API key settings
  api_key:
    prefix: "lg_"
    length: 40

# Rate limiting
rate_limiting:
  enabled: true
  
  # Global rate limit
  global:
    max_requests: 1000
    window_seconds: 60
  
  # Per-IP rate limit
  per_ip:
    max_requests: 100
    window_seconds: 60
  
  # Per-user rate limit
  per_user:
    max_requests: 200
    window_seconds: 60
  
  # Per-endpoint rate limits
  endpoints:
    analyze:
      max_requests: 50
      window_seconds: 60
    
    upload:
      max_requests: 20
      window_seconds: 60
    
    batch:
      max_requests: 10
      window_seconds: 60

# File upload security
file_upload:
  max_file_size_mb: 100
  
  allowed_types:
    - json
    - csv
    - pdf
    - image
  
  # Validate file content (magic bytes)
  validate_content: true
  
  # Scan for viruses (requires ClamAV)
  virus_scan_enabled: false
  
  # Upload directory
  upload_dir: "data/uploads"
  
  # Quarantine directory for suspicious files
  quarantine_dir: "data/quarantine"

# Input validation
validation:
  # Maximum field lengths
  max_lengths:
    land_id: 50
    owner_name: 100
    filename: 255
    description: 1000
  
  # Enable strict validation
  strict_mode: true
  
  # Reject requests with dangerous patterns
  reject_dangerous_patterns: true

# Data encryption
encryption:
  # Enable encryption for sensitive fields
  enabled: true
  
  # Encryption key (load from environment)
  key: "${LANDGUARD_ENCRYPTION_KEY}"
  
  # Fields to encrypt
  encrypted_fields:
    - password
    - secret
    - token
    - api_key
    - private_key

# Audit logging
audit:
  enabled: true
  
  # Log file path
  log_file: "logs/security_audit.log"
  
  # Log to console
  log_to_console: true
  
  # Log level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
  log_level: "INFO"
  
  # Maximum events to keep in memory
  max_events_in_memory: 1000
  
  # Export format (json, csv)
  export_format: "json"
  
  # Log these event types
  log_events:
    - login_success
    - login_failure
    - authentication_failure
    - authorization_failure
    - rate_limit_exceeded
    - file_upload
    - file_upload_rejected
    - suspicious_activity

# Security headers
headers:
  # Enable security headers
  enabled: true
  
  # Specific headers
  x_content_type_options: "nosniff"
  x_frame_options: "DENY"
  x_xss_protection: "1; mode=block"
  strict_transport_security: "max-age=31536000; includeSubDomains"
  content_security_policy: "default-src 'self'"

# CORS settings
cors:
  enabled: true
  allow_origins:
    - "http://localhost:3000"
    - "https://yourdomain.com"
  allow_methods:
    - GET
    - POST
    - PUT
    - DELETE
  allow_headers:
    - "*"
  allow_credentials: true

# IP allowlist/blocklist
ip_filtering:
  enabled: false
  
  # Allowlist (if not empty, only these IPs are allowed)
  allowlist: []
  
  # Blocklist (these IPs are always blocked)
  blocklist: []

# Brute force protection
brute_force_protection:
  enabled: true
  
  # Max failed attempts before blocking
  max_failed_attempts: 5
  
  # Block duration in minutes
  block_duration_minutes: 30
  
  # Time window for counting attempts (minutes)
  time_window_minutes: 15

# Session management
session:
  # Session timeout in minutes
  timeout_minutes: 30
  
  # Enable session refresh
  refresh_enabled: true
  
  # Secure cookie settings
  secure_cookies: true
  httponly_cookies: true
  samesite: "strict"